<!DOCTYPE html><html lang=en><meta charset=utf-8><meta content="width=device-width,initial-scale=1" name=viewport><title>Eli | How to store massive sequence collections in a searchable form</title><link href=/styles.css rel=stylesheet><link href=/favicon-32.png rel=icon sizes=32x32><link href=/favicon-128.png rel=icon sizes=128x128><link href=/favicon-180.png rel=icon sizes=180x180><link href=/favicon-192.png rel=icon sizes=192x192><style id=MJX-CHTML-styles>mjx-container[jax=CHTML]{line-height:0}mjx-container [space="1"]{margin-left:.111em}mjx-container [space="2"]{margin-left:.167em}mjx-container [space="3"]{margin-left:.222em}mjx-container [space="4"]{margin-left:.278em}mjx-container [space="5"]{margin-left:.333em}mjx-container [rspace="1"]{margin-right:.111em}mjx-container [rspace="2"]{margin-right:.167em}mjx-container [rspace="3"]{margin-right:.222em}mjx-container [rspace="4"]{margin-right:.278em}mjx-container [rspace="5"]{margin-right:.333em}mjx-container [size="s"]{font-size:70.7%}mjx-container [size=ss]{font-size:50%}mjx-container [size=Tn]{font-size:60%}mjx-container [size=sm]{font-size:85%}mjx-container [size=lg]{font-size:120%}mjx-container [size=Lg]{font-size:144%}mjx-container [size=LG]{font-size:173%}mjx-container [size=hg]{font-size:207%}mjx-container [size=HG]{font-size:249%}mjx-container [width=full]{width:100%}mjx-box{display:inline-block}mjx-block{display:block}mjx-itable{display:inline-table}mjx-row{display:table-row}mjx-row>*{display:table-cell}mjx-mtext{display:inline-block}mjx-mstyle{display:inline-block}mjx-merror{display:inline-block;color:red;background-color:#ff0}mjx-mphantom{visibility:hidden}_::-webkit-full-page-media,_:future,:root mjx-container{will-change:opacity}mjx-assistive-mml{position:absolute!important;top:0;left:0;clip:rect(1px,1px,1px,1px);padding:1px 0 0 0!important;border:0!important;display:block!important;width:auto!important;overflow:hidden!important;-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}mjx-assistive-mml[display=block]{width:100%!important}mjx-math{display:inline-block;text-align:left;line-height:0;text-indent:0;font-style:normal;font-weight:400;font-size:100%;font-size-adjust:none;letter-spacing:normal;border-collapse:collapse;word-wrap:normal;word-spacing:normal;white-space:nowrap;direction:ltr;padding:1px 0}mjx-container[jax=CHTML][display=true]{display:block;text-align:center;margin:1em 0}mjx-container[jax=CHTML][display=true][width=full]{display:flex}mjx-container[jax=CHTML][display=true] mjx-math{padding:0}mjx-container[jax=CHTML][justify=left]{text-align:left}mjx-container[jax=CHTML][justify=right]{text-align:right}mjx-mi{display:inline-block;text-align:left}mjx-c{display:inline-block}mjx-utext{display:inline-block;padding:.75em 0 .2em 0}mjx-mo{display:inline-block;text-align:left}mjx-stretchy-h{display:inline-table;width:100%}mjx-stretchy-h>*{display:table-cell;width:0}mjx-stretchy-h>*>mjx-c{display:inline-block;transform:scalex(1.0000001)}mjx-stretchy-h>*>mjx-c::before{display:inline-block;width:initial}mjx-stretchy-h>mjx-ext{overflow:hidden;overflow:clip visible;width:100%}mjx-stretchy-h>mjx-ext>mjx-c::before{transform:scalex(500)}mjx-stretchy-h>mjx-ext>mjx-c{width:0}mjx-stretchy-h>mjx-beg>mjx-c{margin-right:-.1em}mjx-stretchy-h>mjx-end>mjx-c{margin-left:-.1em}mjx-stretchy-v{display:inline-block}mjx-stretchy-v>*{display:block}mjx-stretchy-v>mjx-beg{height:0}mjx-stretchy-v>mjx-end>mjx-c{display:block}mjx-stretchy-v>*>mjx-c{transform:scaley(1.0000001);transform-origin:left center;overflow:hidden}mjx-stretchy-v>mjx-ext{display:block;height:100%;box-sizing:border-box;border:0 solid transparent;overflow:hidden;overflow:visible clip}mjx-stretchy-v>mjx-ext>mjx-c::before{width:initial;box-sizing:border-box}mjx-stretchy-v>mjx-ext>mjx-c{transform:scaleY(500) translateY(.075em);overflow:visible}mjx-mark{display:inline-block;height:0}mjx-msup{display:inline-block;text-align:left}mjx-mn{display:inline-block;text-align:left}mjx-c::before{display:block;width:0}.MJX-TEX{font-family:MJXZERO,MJXTEX}.TEX-B{font-family:MJXZERO,MJXTEX-B}.TEX-I{font-family:MJXZERO,MJXTEX-I}.TEX-MI{font-family:MJXZERO,MJXTEX-MI}.TEX-BI{font-family:MJXZERO,MJXTEX-BI}.TEX-S1{font-family:MJXZERO,MJXTEX-S1}.TEX-S2{font-family:MJXZERO,MJXTEX-S2}.TEX-S3{font-family:MJXZERO,MJXTEX-S3}.TEX-S4{font-family:MJXZERO,MJXTEX-S4}.TEX-A{font-family:MJXZERO,MJXTEX-A}.TEX-C{font-family:MJXZERO,MJXTEX-C}.TEX-CB{font-family:MJXZERO,MJXTEX-CB}.TEX-FR{font-family:MJXZERO,MJXTEX-FR}.TEX-FRB{font-family:MJXZERO,MJXTEX-FRB}.TEX-SS{font-family:MJXZERO,MJXTEX-SS}.TEX-SSB{font-family:MJXZERO,MJXTEX-SSB}.TEX-SSI{font-family:MJXZERO,MJXTEX-SSI}.TEX-SC{font-family:MJXZERO,MJXTEX-SC}.TEX-T{font-family:MJXZERO,MJXTEX-T}.TEX-V{font-family:MJXZERO,MJXTEX-V}.TEX-VB{font-family:MJXZERO,MJXTEX-VB}mjx-stretchy-h mjx-c,mjx-stretchy-v mjx-c{font-family:MJXZERO,MJXTEX-S1,MJXTEX-S4,MJXTEX,MJXTEX-A!important}@font-face{font-family:MJXZERO;src:url(https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Zero.woff) format("woff")}@font-face{font-family:MJXTEX;src:url(https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Main-Regular.woff) format("woff")}@font-face{font-family:MJXTEX-B;src:url(https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Main-Bold.woff) format("woff")}@font-face{font-family:MJXTEX-I;src:url(https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Math-Italic.woff) format("woff")}@font-face{font-family:MJXTEX-MI;src:url(https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Main-Italic.woff) format("woff")}@font-face{font-family:MJXTEX-BI;src:url(https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Math-BoldItalic.woff) format("woff")}@font-face{font-family:MJXTEX-S1;src:url(https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Size1-Regular.woff) format("woff")}@font-face{font-family:MJXTEX-S2;src:url(https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Size2-Regular.woff) format("woff")}@font-face{font-family:MJXTEX-S3;src:url(https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Size3-Regular.woff) format("woff")}@font-face{font-family:MJXTEX-S4;src:url(https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Size4-Regular.woff) format("woff")}@font-face{font-family:MJXTEX-A;src:url(https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_AMS-Regular.woff) format("woff")}@font-face{font-family:MJXTEX-C;src:url(https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Calligraphic-Regular.woff) format("woff")}@font-face{font-family:MJXTEX-CB;src:url(https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Calligraphic-Bold.woff) format("woff")}@font-face{font-family:MJXTEX-FR;src:url(https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Fraktur-Regular.woff) format("woff")}@font-face{font-family:MJXTEX-FRB;src:url(https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Fraktur-Bold.woff) format("woff")}@font-face{font-family:MJXTEX-SS;src:url(https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_SansSerif-Regular.woff) format("woff")}@font-face{font-family:MJXTEX-SSB;src:url(https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_SansSerif-Bold.woff) format("woff")}@font-face{font-family:MJXTEX-SSI;src:url(https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_SansSerif-Italic.woff) format("woff")}@font-face{font-family:MJXTEX-SC;src:url(https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Script-Regular.woff) format("woff")}@font-face{font-family:MJXTEX-T;src:url(https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Typewriter-Regular.woff) format("woff")}@font-face{font-family:MJXTEX-V;src:url(https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Vector-Regular.woff) format("woff")}@font-face{font-family:MJXTEX-VB;src:url(https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Vector-Bold.woff) format("woff")}mjx-c.mjx-c1D442.TEX-I::before{padding:.704em .763em .022em 0;content:"O"}mjx-c.mjx-c28::before{padding:.75em .389em .25em 0;content:"("}mjx-c.mjx-c1D450.TEX-I::before{padding:.442em .433em .011em 0;content:"c"}mjx-c.mjx-c29::before{padding:.75em .389em .25em 0;content:")"}mjx-c.mjx-c6C::before{padding:.694em .278em 0 0;content:"l"}mjx-c.mjx-c6F::before{padding:.448em .5em .01em 0;content:"o"}mjx-c.mjx-c67::before{padding:.453em .5em .206em 0;content:"g"}mjx-c.mjx-c2061::before{padding:0;content:""}mjx-c.mjx-c1D45B.TEX-I::before{padding:.442em .6em .011em 0;content:"n"}mjx-c.mjx-c32::before{padding:.666em .5em 0 0;content:"2"}</style><nav><h2><a href=/ >e l i</a></h2><ul><li><a href=/blog/ >blog</a><li><a href=/projects/ >projects</a><li><a href=/notes/ >notes</a></ul></nav><article><header><h1 class=title>How to store massive sequence collections in a searchable form</h1>Speaker: Dominik Kempa | Date: 2020-03-11</header><p>Our goal is to compress sequential data in an (efficiently) searchable form.<p>The motivation is the Human Genome Project. It has produced 75 TiB of raw information but ~99% of all of that information is identical. Therefore traditional compression algorithms work extremely well, for example we can compress the raw data to about ~0.7 GiB with just <code>zip</code>. This form is not searchable.<p>There are other compression algorithms which are searchable however. You create an index and then compress that. This gives you a small searchable index.<p><em>Note:</em> The compression indexes we'll be talking about only support full matches. Work is done on supporting any regular expression.<p>Index have the following properties:<ul><li><strong>Size:</strong> is how large the compressed algorithm is. Normally compressed indexes have size of <mjx-container class=MathJax jax=CHTML style=font-size:113.1%;position:relative><mjx-math aria-hidden=true class=MJX-TEX><mjx-mi class=mjx-i><mjx-c class="TEX-I mjx-c1D442"></mjx-c></mjx-mi><mjx-mo class=mjx-n><mjx-c class=mjx-c28></mjx-c></mjx-mo><mjx-mi class=mjx-i><mjx-c class="TEX-I mjx-c1D450"></mjx-c></mjx-mi><mjx-mo class=mjx-n><mjx-c class=mjx-c29></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math xmlns=http://www.w3.org/1998/Math/MathML><mi>O</mi><mo stretchy=false>(</mo><mi>c</mi><mo stretchy=false>)</mo></math></mjx-assistive-mml></mjx-container> or <mjx-container class=MathJax jax=CHTML style=font-size:113.1%;position:relative><mjx-math aria-hidden=true class=MJX-TEX><mjx-mi class=mjx-i><mjx-c class="TEX-I mjx-c1D442"></mjx-c></mjx-mi><mjx-mo class=mjx-n><mjx-c class=mjx-c28></mjx-c></mjx-mo><mjx-mi class=mjx-i><mjx-c class="TEX-I mjx-c1D450"></mjx-c></mjx-mi><mjx-mi class=mjx-n space=2><mjx-c class=mjx-c6C></mjx-c><mjx-c class=mjx-c6F></mjx-c><mjx-c class=mjx-c67></mjx-c></mjx-mi><mjx-mo class=mjx-n><mjx-c class=mjx-c2061></mjx-c></mjx-mo><mjx-mi class=mjx-i space=2><mjx-c class="TEX-I mjx-c1D45B"></mjx-c></mjx-mi><mjx-mo class=mjx-n><mjx-c class=mjx-c29></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math xmlns=http://www.w3.org/1998/Math/MathML><mi>O</mi><mo stretchy=false>(</mo><mi>c</mi><mi>log</mi><mo data-mjx-texclass=NONE>⁡</mo><mi>n</mi><mo stretchy=false>)</mo></math></mjx-assistive-mml></mjx-container> where <mjx-container class=MathJax jax=CHTML style=font-size:113.1%;position:relative><mjx-math aria-hidden=true class=MJX-TEX><mjx-mi class=mjx-i><mjx-c class="TEX-I mjx-c1D450"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math xmlns=http://www.w3.org/1998/Math/MathML><mi>c</mi></math></mjx-assistive-mml></mjx-container> is the compressed size.<li><strong>Functionality:</strong> is what kind of searches the index can support. Normally either plain access (weak) or full search (powerful).<li><strong>Query Time:</strong> is how long the search takes. Normally the runtime for these "fast" indexes are <mjx-container class=MathJax jax=CHTML style=font-size:113.1%;position:relative><mjx-math aria-hidden=true class=MJX-TEX><mjx-mi class=mjx-i><mjx-c class="TEX-I mjx-c1D442"></mjx-c></mjx-mi><mjx-mo class=mjx-n><mjx-c class=mjx-c28></mjx-c></mjx-mo><mjx-mi class=mjx-n><mjx-c class=mjx-c6C></mjx-c><mjx-c class=mjx-c6F></mjx-c><mjx-c class=mjx-c67></mjx-c></mjx-mi><mjx-mo class=mjx-n><mjx-c class=mjx-c2061></mjx-c></mjx-mo><mjx-mi class=mjx-i space=2><mjx-c class="TEX-I mjx-c1D45B"></mjx-c></mjx-mi><mjx-mo class=mjx-n><mjx-c class=mjx-c29></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math xmlns=http://www.w3.org/1998/Math/MathML><mi>O</mi><mo stretchy=false>(</mo><mi>log</mi><mo data-mjx-texclass=NONE>⁡</mo><mi>n</mi><mo stretchy=false>)</mo></math></mjx-assistive-mml></mjx-container> or <mjx-container class=MathJax jax=CHTML style=font-size:113.1%;position:relative><mjx-math aria-hidden=true class=MJX-TEX><mjx-mi class=mjx-i><mjx-c class="TEX-I mjx-c1D442"></mjx-c></mjx-mi><mjx-mo class=mjx-n><mjx-c class=mjx-c28></mjx-c></mjx-mo><mjx-msup><mjx-mi class=mjx-n><mjx-c class=mjx-c6C></mjx-c><mjx-c class=mjx-c6F></mjx-c><mjx-c class=mjx-c67></mjx-c></mjx-mi><mjx-script style=vertical-align:.421em><mjx-mn class=mjx-n size=s><mjx-c class=mjx-c32></mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo class=mjx-n><mjx-c class=mjx-c2061></mjx-c></mjx-mo><mjx-mi class=mjx-i space=2><mjx-c class="TEX-I mjx-c1D45B"></mjx-c></mjx-mi><mjx-mo class=mjx-n><mjx-c class=mjx-c29></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math xmlns=http://www.w3.org/1998/Math/MathML><mi>O</mi><mo stretchy=false>(</mo><msup><mi>log</mi><mn>2</mn></msup><mo data-mjx-texclass=NONE>⁡</mo><mi>n</mi><mo stretchy=false>)</mo></math></mjx-assistive-mml></mjx-container>.</ul><p>There are two main approaches for building these kind of indexes. There is <strong>offline</strong>, which constructs some query-able data structure to disk. This takes a lot of CPU and time but supports faster querying in general. There is <strong>online</strong> which queries more directly.<p>There are three main lossless compression types:<ul><li>Statistical coding<li>Lempel-Ziv<li>Burrows-Wheeler transform</ul><p>We are the least interested in statistical coding because it lacks an interesting property (that I didn't write down).<p>Interesting, Lempel-Ziv and Burrows-Wheeler compression types are equivalent up to <mjx-container class=MathJax jax=CHTML style=font-size:113.1%;position:relative><mjx-math aria-hidden=true class=MJX-TEX><mjx-mi class=mjx-i><mjx-c class="TEX-I mjx-c1D442"></mjx-c></mjx-mi><mjx-mo class=mjx-n><mjx-c class=mjx-c28></mjx-c></mjx-mo><mjx-mi class=mjx-n><mjx-c class=mjx-c6C></mjx-c><mjx-c class=mjx-c6F></mjx-c><mjx-c class=mjx-c67></mjx-c></mjx-mi><mjx-mo class=mjx-n><mjx-c class=mjx-c2061></mjx-c></mjx-mo><mjx-mi class=mjx-i space=2><mjx-c class="TEX-I mjx-c1D45B"></mjx-c></mjx-mi><mjx-mo class=mjx-n><mjx-c class=mjx-c29></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math xmlns=http://www.w3.org/1998/Math/MathML><mi>O</mi><mo stretchy=false>(</mo><mi>log</mi><mo data-mjx-texclass=NONE>⁡</mo><mi>n</mi><mo stretchy=false>)</mo></math></mjx-assistive-mml></mjx-container> runtime scaling.</article>